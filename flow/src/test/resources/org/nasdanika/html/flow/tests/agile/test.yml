flow-package:
  uri: nasdanika://flow/test
  name: Test Flow
  description: Test flow for troubleshooting, copied from Agile Core.
  participants:
    product-owner:
      name: Product Owner
      documentation: 
        content-interpolator:
          source:
            content-markdown:
              source:
                content-text: Creates and ``grooms`` stories. ${my-token}.
    team-member:
      name: Team Member
      documentation: 
        content-markdown:
          source:
            content-text: Base participant.
    scrum-master:
      name: Scrum Master
      description: Drives sprint execution.
    architect:
      name: Architect
      description: Keeps the product aligned to the architectural guidelines.
    developer:
      name: Developer
      bases: team-member
      description: Implements stories and tests in their local environment
    lead-developer:
      name: Lead Developer
      description: Developer leading development efforts and coaching the development team.
      bases: developer
    tester:
      name: Tester
      description: Tests in runtime environment
  resources:
    issue-tracker:
      name: Issue Tracker
      modifiers: abstract
      description: Repository of stories      
    source-repository:
      name: Source Repository
      modifiers: abstract
      description: Repository of source code
    ide:
      name: Development Environment
      modifiers: abstract
      services:
        install:
          flow-flow:
            name: Installation
            description: Do this and then that
            representations:
              flow:
                hide-empty-description: true
                vertical: false
                context: 1                
            elements:
              step-one:
                flow-activity:
                  name: Step 1
                  outputs:
                    step-two:
                      target: step-two
              step-two:
                flow-flow:
                  name: Step 2
                  representations:
                    flow:
                      hide-empty-description: true
                      vertical: false                
                  elements:
                    step-2.1:
                      flow-activity:
                        name: 2.1
                    step-2.2:
                      flow-activity:
                        name: 2.2
    build-tool:
      name: Build tool
      modifiers: abstract
    runtime:
      name: Runtime
      modifiers: abstract
      description: Execution environment for the binary artifacts.
  artifacts:
    story:
      name: User story
      description: Describes increment in product fucntionality.
      repositories: issue-tracker
    source:
      name: Source code
      description: A collection of artifacts stored in the source repository and used to build a binary.
      repositories: source-repository
      responsible: developer
      accountable: lead-developer
      consulted: architect
      informed: [product-owner, tester]                
    binary:
      name: Binary artifact(s)
      description: Artifacts built from source code for execution in runtime environments.
      modifiers: abstract
  activities:
    test:
      flow-flow:
        name: Test
        representations:
          flow:
            hide-empty-description: true
            vertical: false
          generated: 
            type: drawio:./test.drawio
            name: Drawio
            description: Generated diagram
        elements:
          start:
            flow-start: 
              outputs:
                one:
                  target: one
                two:
                  target: uno
                choice:
                  target: choice
                service: 
                  target: service
          choice:
            flow-choice:
              outputs:
                one-a:
                  target: one-a
                three:
                  target: three
                fork:
                  target: fork
          service:
            flow-service:
              name: Install stuff
              target: nasdanika://flow/test/resources/ide/services/install 
              documentation:
                content-interpolator:
                  #process-includes: false
                  source:
                    content-markdown:
                      style: true
                      source:
                        content-resource: install.md       
          one:
            flow-activity:
              name: One 
              outputs:
                one:
                  target: one-a
              calls:
                installation:
                  target: nasdanika://flow/test/resources/ide/services/install
                  description: Install things.
              participants: developer
              resources: source-repository              
              representations:
                flow:
                  hide-empty-description: true
                  vertical: false
                  context: 1                  
          uno:
            flow-activity:
              name: Uno 
              outputs:
                two:
                  target: two
              representations:
                flow:
                  hide-empty-description: true
                  vertical: false
                  context: 1                  
          one-a:
            flow-activity:
              name: 1.a 
              outputs:
                fork:
                  target: fork
              representations:
                flow:
                  hide-empty-description: true
                  vertical: false
                  context: 1   
          fork:
            flow-fork:
              description: Fork on the road
              outputs:
                one-b:
                  target: one-b                       
                two:
                  target: two                       
          one-b:
            flow-activity:
              name: 1.b 
              outputs:
                one:
                  target: end
              representations:
                flow:
                  hide-empty-description: true
                  vertical: false
                  context: 1                  
          two:
            flow-flow:
              name: Two 
              representations:
                flow:
                  hide-empty-description: true
                  vertical: false
                  context: 1                  
              partition: true
              outputs:
                one:
                  target: four
              elements:
                start:
                  flow-start: 
                    outputs:
                      one:
                        target: one
                      two:
                        target: two
                      three:
                        target: three
                one:
                  flow-activity:
                    name: 2.1 
                    outputs:
                      one:
                        target: end
                two:
                  flow-flow:
                    name: 2.2 
                    calls:
                      install:
                        target: nasdanika://flow/test/resources/ide/services/install
                    representations:
                      flow:
                        hide-empty-description: true
                        vertical: false
                        context: 1                  
                    outputs:
                      one:
                        target: end
                three:
                  flow-activity:
                    name: 2.3 
                    outputs:
                      one:
                        target: end
                end:
                  flow-end: {}              
          three:
            flow-activity:
              name: Three 
              outputs:
                one:
                  target: end
              representations:
                flow:
                  hide-empty-description: true
                  vertical: false
                  context: 1                  
          four:
            flow-activity:
              name: Four 
              outputs:
                end:
                  target: end
              representations:
                flow:
                  hide-empty-description: true
                  vertical: false
                  context: 1                  
          end:
            flow-end: {} 
            