flow-package:
  uri: nasdanika://agile/core
  description: Generic agile software development.
  name: Core Agile Flows
  modifiers: abstract 
  participants:
    product-owner:
      name: Product Owner
      documentation: 
        content-markdown:
          source:
            content-text: Creates and ``grooms`` stories.
    scrum-master:
      name: Scrum Master
      description: Drives sprint execution.
    architect:
      name: Architect
      description: Keeps the product aligned to the architectural guidelines.
    developer:
      name: Developer
      description: Implements stories and tests in their local environment
    lead-developer:
      name: Lead Developer
      description: Developer leading development efforts and coaching the development team.
      bases: developer
    tester:
      name: Tester
      description: Tests in runtime environment
  resources:
    issue-tracker:
      name: Issue Tracker
      modifiers: abstract
      description: Repository of stories      
    source-repository:
      name: Source Repository
      modifiers: abstract
      description: Repository of source code
    ide:
      name: Development Environment
      modifiers: abstract
      services:
        install:
          flow-activity:
            name: Installation
            description: ...
    build-tool:
      name: Build tool
      modifiers: abstract
    runtime:
      name: Runtime
      modifiers: abstract
      description: Execution environment for the binary artifacts.
  artifacts:
    story:
      name: User story
      description: Describes increment in product fucntionality.
      repositories: issue-tracker
    source:
      name: Source code
      description: A collection of artifacts stored in the source repository and used to build a binary.
      repositories: source-repository
      responsible: developer
      accountable: lead-developer
      consulted: architect
      informed: [product-owner, tester]                
    binary:
      name: Binary artifact(s)
      description: Artifacts built from source code for execution in runtime environments.
      modifiers: abstract
  activities:
    development:
      flow-flow:
        name: Agile development
        representations:
          flow:
            hide-empty-description: true
            vertical: false
          generated: 
            type: drawio
            name: Agile Development
            description: Generated diagram
          manual: 
            type: "drawio:core/flows/agile-development.drawio"
            name: Generated diagram
            description: Generated and then manually edited diagram
        elements:
          create:
            flow-activity:
              name: Create a story
              description: Product Owner creates a new story in the issue tracker.
              participants: product-owner
              resources: issue-tracker
              output-artifacts: story
              modifiers: final
              responsible: product-owner
              accountable: product-owner
              consulted: lead-developer
              informed: [developer, tester]                
              representations:
                flow:
                  hide-empty-description: true
                  vertical: false
                  context: 1
              outputs: 
                groom:
                  target: groom
                  payload: story
          groom:
            flow-activity:
              name: Groom a story
              modifiers: optional
              description: Product Owner elaborates a story so it has enough details for development and testing.
              participants: product-owner
              resources: issue-tracker
              input-artifacts: story
              output-artifacts: story
              responsible: product-owner
              accountable: product-owner
              consulted: [lead-developer, developer, architect]
              informed: tester                
              outputs: 
                is-architecturally-significant:
                  target: is-architecturally-significant
                  payload: story
          is-architecturally-significant:
            flow-choice:
              name: Architecturally significant
              description: Decision whether the story is architecturally significant and requires an architectural review.
              participants: product-owner
              resources: issue-tracker
              input-artifacts: story
              output-artifacts: story
              outputs: 
                review:
                  target: architectural-review
                  name: "Yes"
                  payload: story
                  documentation:
                    content-markdown:
                      source:
                        content-text: Architecturally significant stories need to go through an architectural review. 
                develop:
                  target: develop/elements/code
                  name: "No"
                  payload: story                    
                  documentation:
                    content-markdown:
                      source:
                        content-text: Stories which are not architecturally significant go straight to development. 
          architectural-review:
            flow-activity:
              name: Architectural review with a long description to test word wrapping and line increment
              description: Architect reviews architecturally significant stories and releases them to development or sends back with comments for additional grooming.
              participants: architect
              resources: issue-tracker
              input-artifacts: story
              output-artifacts: story
              outputs: 
                develop:
                  target: develop/elements/code
                  payload: story
                  documentation:
                    content-markdown:
                      source:
                        content-text: Approved ``stories`` transition to the development. 
          develop:
            flow-flow:
              name: Develop a story
              representations:
                context:
                  context: 1
                  hide-empty-description: true
              partition: true
              description: Developer creates or modifies source code to implement story functionality.
              participants: developer
              modifiers: abstract
              resources: 
                - issue-tracker
                - source-repository
                - ide
              input-artifacts: story
              output-artifacts: source
              elements:
                code:
                  flow-activity:
                    name: Code
                    outputs:
                      unit-test:
                        target: unit-test
                      document:
                        target: document
                    artifact-responsibilities: # Artifact responsibilities
                      story:
                        responsible: developer
                        accountable: scrum-master
                        consulted: [lead-developer, architect]
                        informed: [product-owner, tester]
                        description: |+2
                          Developer changes story status to "In progress" and adds comments about the progress or questions requiring clarifications. 
                          Other responsible subscribe to the story to receive notifications and provide clarifications.                                   
                      source:
                        responsible: developer
                        accountable: lead-developer
                        consulted: [product-owner, architect]
                        informed: [scrum-master, tester]
                        description: |+2
                          Developer writes code and reaches out to the product owner and architect for clarifications. Informs the scrum master and the tester on the progress.     
                unit-test:
                  flow-activity:
                    name: Unit test
                    outputs:
                      join:
                        target: join
                document:
                  flow-activity:
                    name: Document
                    outputs:
                      join:
                        target: join
                join:
                  flow-join:
                    outputs:
                      peer-review:
                        target: peer-review
                peer-review:
                  flow-activity:
                    name: Peer review
                    responsible: developer
                    accountable: lead-developer
                    consulted: [architect, tester]
                    informed: product-owner                
                    outputs:
                      build:
                        target: ../../build
          build:
            flow-activity:
              name: Build
              description: Developer or an automated process builds sources to produce binaries.
              participants: developer
              resources: 
                - source-repository
                - build-tool
                - runtime
              input-artifacts: source
              output-artifacts: binary
              outputs: 
                test:
                  target: test
          test:
            flow-activity:
              name: Test
              description: Tester validates story functionality using the binary produced in build activity.
              participants: tester
              responsible: tester
              accountable: product-owner
              consulted: developer
              informed: [lead-developer, architect]                
              resources: 
                - runtime
                - issue-tracker
              input-artifacts: 
               - story
               - binary
            