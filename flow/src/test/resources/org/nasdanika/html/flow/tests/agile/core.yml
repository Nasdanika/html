flow-package:
  uri: nasdanika://agile/core
  description: Generic agile software development.
  name: Core Agile Flows
  modifiers: abstract 
  participants:
    product-owner:
      name: Product Owner
      documentation: 
        content-markdown:
          source:
            content-text: Creates and ``grooms`` stories.
    architect:
      name: Architect
      description: Keeps the product aligned to the architectural guidelines.
    developer:
      name: Developer
      description: Implements stories and tests in their local environment
    tester:
      name: Tester
      description: Tests in runtime environment
  resources:
    issue-tracker:
      name: Issue Tracker
      modifiers: abstract
      description: Repository of stories
    source-repository:
      name: Source Repository
      modifiers: abstract
      description: Repository of source code
    ide:
      name: Development Environment
      modifiers: abstract
    build-tool:
      name: Build tool
      modifiers: abstract
    runtime:
      name: Runtime
      modifiers: abstract
      description: Execution environment for the binary artifacts.
  artifacts:
    story:
      name: User story
      description: Describes increment in product fucntionality.
      repositories: issue-tracker
    source:
      name: Source code
      description: A collection of artifacts stored in the source repository and used to build a binary.
      repositories: source-repository
    binary:
      name: Binary artifact(s)
      description: Artifacts built from source code for execution in runtime environments.
      modifiers: abstract
  activities:
    development:
      flow-flow:
        name: Agile development
        elements:
          create:
            flow-activity:
              name: Create a story
              description: Product Owner creates a new story in the issue tracker.
              participants: product-owner
              resources: issue-tracker
              output-artifacts: story
              modifiers: final
              outputs: 
                groom:
                  target: groom
                  payload: story
          groom:
            flow-activity:
              name: Groom a story
              description: Product Owner elaborates a story so it has enough details for development and testing.
              participants: product-owner
              resources: issue-tracker
              input-artifacts: story
              output-artifacts: story
              outputs: 
                is-architecturally-significant:
                  target: is-architecturally-significant
                  payload: story
          is-architecturally-significant:
            flow-choice:
              name: Architecturally significant
              description: Decision whether the story is architecturally significant and requires an architectural review.
              participants: product-owner
              resources: issue-tracker
              input-artifacts: story
              output-artifacts: story
              outputs: 
                review:
                  target: architectural-review
                  name: "Yes"
                  payload: story
                  documentation:
                    content-markdown:
                      source:
                        content-text: Architecturally significant stories need to go through an architectural review. 
                develop:
                  target: develop/elements/code
                  name: "No"
                  payload: story                    
                  documentation:
                    content-markdown:
                      source:
                        content-text: Stories which are not architecturally significant go straight to development. 
          architectural-review:
            flow-activity:
              name: Architectural review
              description: Architect reviews architecturally significan stories and releases them to development or sends back with comments for additional grooming.
              participants: architect
              resources: issue-tracker
              input-artifacts: story
              output-artifacts: story
              outputs: 
                develop:
                  target: develop/elements/code
                  payload: story
                  documentation:
                    content-markdown:
                      source:
                        content-text: Approved ``stories`` transition to the development. 
          develop:
            flow-flow:
              name: Develop a story
              partition: true
              description: Developer creates or modifies source code to implement story functionality.
              participants: developer
              modifiers: abstract
              resources: 
                - issue-tracker
                - source-repository
                - ide
              input-artifacts: story
              output-artifacts: source
              elements:
                code:
                  flow-activity:
                    name: Code
                    outputs:
                      unit-test:
                        target: unit-test
                      document:
                        target: document
                unit-test:
                  flow-activity:
                    name: Unit test
                    outputs:
                      join:
                        target: join
                document:
                  flow-activity:
                    name: Document
                    outputs:
                      join:
                        target: join
                join:
                  flow-join:
                    outputs:
                      build:
                        target: ../../build
          build:
            flow-activity:
              name: Build
              description: Developer or an automated process builds sources to produce binaries.
              participants: developer
              resources: 
                - source-repository
                - build-tool
                - runtime
              input-artifacts: source
              output-artifacts: binary
              outputs: 
                test:
                  target: test
          test:
            flow-activity:
              name: Test
              description: Tester validates story functionality using the binary produced in build activity.
              participants: tester
              resources: 
                - runtime
                - issue-tracker
              input-artifacts: 
               - story
               - binary
            